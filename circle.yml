test:
  override:
    - bundle exec bin/pw generate example.rb
  post:
    - gem build parawall.gemspec
    - fpm -s gem -t deb -v 0.0.1 parawall-0.0.1.gem
dependencies:
  pre:
    - gem install fpm
    - gem install package_cloud
general:
  artifacts:
    - "parawall-0.0.1.gem"
    - "rubygem-parawall_0.0.1_all.deb"
deployment:
  production:
    branch: master
    commands:
      - package_cloud push splaspood/projects parawall-0.0.1.gem
      - package_cloud push splaspood/projects/ubuntu/trusty rubygem-parawall_0.0.1_all.deb
machine:
  environment:
    PROJECT_VERSION: "$(grep 's\.version' parawall.gemspec | cut -f2 -d= | tr -d " '")"
